<%- include('../partials/header', { title: "My Surveys", user: user }) %>

<div class="page-header">
    <h1>My Completed Surveys</h1>
    <p>View your survey responses</p>
</div>

<!-- Search Bar -->
<div class="form-group" style="margin-bottom: 1.5rem;">
    <input id="surveySearch" type="text" class="form-control"
        placeholder="Search by event name or date...">
</div>

<div class="table-container">
    <table id="surveyTable">
        <thead>
            <tr>
                <th>Event</th>
                <th>Date</th>
                <th>Responses</th>
                <th>Comments</th>
            </tr>
        </thead>
        <tbody>
            <% if (completedSurveys.length === 0) { %>
                <tr>
                    <td colspan="4" class="text-center">No surveys have been completed yet.</td>
                </tr>
            <% } else { %>
                <% completedSurveys.forEach(s => { %>
                <tr>
                    <td><%= s.eventname || 'Unknown Event' %></td>
                    <td><%= s.eventdate || 'N/A' %></td>
                    <td>
                        Sat: <%= s.surveysatisfactionscore || '—' %> |
                        Use: <%= s.surveyusefulnessscore || '—' %> |
                        Inst: <%= s.surveyinstructorscore || '—' %> |
                        Rec: <%= s.surveyrecommendationscore || '—' %> |
                        Ovrl: <%= s.surveyoverallscore || '—' %>
                    </td>
                    <td><%= s.surveycomments || "—" %></td>
                </tr>
                <% }) %>
            <% } %>
        </tbody>
    </table>
</div>

<script>
// Live Search Filter
document.getElementById("surveySearch").addEventListener("input", function () {
    const term = this.value.toLowerCase();
    const rows = document.querySelectorAll("#surveyTable tbody tr");

    rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(term) ? "" : "none";
    });
});
</script>

<%- include('../partials/footer') %>

